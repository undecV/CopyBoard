<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <script>
    // Customize Your CopyBoard Here!
    const buttonMap = {
      "Emoji": [
        ["😂", "🤣", "😅", "😆", "😎", "😏", "😪", "😉", "🤔", "🤷‍♀️", "🤦‍♀️", "👌", "🖖", "🤟", "💮", "💢", "🍜", "🍭"],
        ["（・ω<）てへぺろ", "ヾ(≧∇≦*)ゝおはよんよん♪", "(*´･д･)ﾉ☆ｺﾝﾊﾞﾝﾊ☆", "（・∀・）∩＜やぁ！！"],
      ], "Greek": [
        ["α", "β", "γ", "δ", "ϵ", "ζ", "η", "θ", "ι", "κ", "λ", "μ", "ν", "ξ", "ο", "π", "ρ", "σ", "τ", "υ", "ϕ", "χ", "ψ", "ω"],
        ["Α", "Β", "Γ", "Δ", "Ε", "Ζ", "Η", "Θ", "Ι", "Κ", "Λ", "Μ", "Ν", "Ξ", "Ο", "Π", "Ρ", "Σ", "Τ", "Υ", "Φ", "Χ", "Ψ", "Ω"],
      ], "Math": [
        ["ε", "ϑ", "ϰ", "ϖ", "ϱ", "ς", "φ", "ϒ"],
        ["×", "÷", "√", "∞", "π", "≠", "≤", "≥", "≃", "∫", "∑", "∏", "∂", "∇", "⊕", "⊗", "∧", "∨", "¬", "⊻", "⊼", "⊽"],
        ["⫫", "∅", "∈", "∋", "∉", "∌", "⊂", "⊃", "⊆", "⊇", "⊄", "⊅", "⋃", "⋂", "∀", "∃", "∄", "∍", "∴", "∵"],
      ]
    }
  </script>

  <title>CopyBoard</title>
  <meta name="robots" content="noindex" />
  <link rel="icon"
    href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>📋</text></svg>">

  <style>
    /* Default theme.*/
    :root {
      /* Color theme: Tomorrow */
      --foreground: #4d4d4c;
      --background: #ffffff;
      --selection: #d6d6d6;
      --line: #efefef;
      --comment: #8e908c;
      --red: #c82829;
      --orange: #f5871f;
      --yellow: #eab700;
      --green: #718c00;
      --aqua: #3e999f;
      --blue: #4271ae;
      --purple: #8959a8;
      --window: #efefef;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        /* Color theme: Tomorrow Night */
        --foreground: #c5c8c6;
        --background: #1d1f21;
        --selection: #373b41;
        --line: #282a2e;
        --comment: #969896;
        --red: #cc6666;
        --orange: #de935f;
        --yellow: #f0c674;
        --green: #b5bd68;
        --aqua: #8abeb7;
        --blue: #81a2be;
        --purple: #b294bb;
        --window: #4d5057;
      }
    }

    @media (prefers-color-scheme: light) {
      :root {
        /* Color theme: Tomorrow */
        --foreground: #4d4d4c;
        --background: #ffffff;
        --selection: #d6d6d6;
        --line: #efefef;
        --comment: #8e908c;
        --red: #c82829;
        --orange: #f5871f;
        --yellow: #eab700;
        --green: #718c00;
        --aqua: #3e999f;
        --blue: #4271ae;
        --purple: #8959a8;
        --window: #efefef;
      }
    }

    :root[data-theme="light"] {
      /* Color theme: Tomorrow */
      --foreground: #4d4d4c;
      --background: #ffffff;
      --selection: #d6d6d6;
      --line: #efefef;
      --comment: #8e908c;
      --red: #c82829;
      --orange: #f5871f;
      --yellow: #eab700;
      --green: #718c00;
      --aqua: #3e999f;
      --blue: #4271ae;
      --purple: #8959a8;
      --window: #efefef;
    }

    :root[data-theme="dark"] {
      /* Color theme: Tomorrow Night */
      --foreground: #c5c8c6;
      --background: #1d1f21;
      --selection: #373b41;
      --line: #282a2e;
      --comment: #969896;
      --red: #cc6666;
      --orange: #de935f;
      --yellow: #f0c674;
      --green: #b5bd68;
      --aqua: #8abeb7;
      --blue: #81a2be;
      --purple: #b294bb;
      --window: #4d5057;
    }

    :root {
      color-scheme: light dark;
      --radius: .5em;
      --sans-serif: system-ui, sans-serif;
    }

    html,
    body {
      height: 100%;
      min-width: 100%;
      background-color: var(--background);
      color: var(--foreground);
      font-family: var(--sans-serif);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    main {
      width: 100%;
      height: 100%;
      flex: 1;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    div.container#main-container {
      width: 80%;
      display: flex;
      text-align: center;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 1em;
    }

    input#copy-text {
      font-size: 1.6em;
      text-align: center;
      width: 60%;
      color: var(--foreground);
      background-color: var(--selection);
      border: none;
      border-radius: var(--radius);
      padding: .2em 1em;
    }

    input#copy-text:focus {
      outline: .2em solid var(--blue);
    }

    hr {
      min-height: .15em;
      width: 100%;
      border: none;
      border-radius: var(--radius);
      color: var(--line);
      background-color: var(--line);
    }

    button {
      font-family: monospace;
      color: var(--foreground);
      background-color: var(--line);
      border: None;
      border-radius: var(--radius);
      padding: .2em .2em;
    }

    button:hover {
      background-color: var(--selection);
    }

    button:focus {
      background-color: var(--selection);
      outline: .2em solid var(--blue);
    }

    .text-button {
      font-size: 1em;
    }

    .tab-view-container {
      display: flex;
      text-align: center;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 1em;
    }

    .tab-view {
      display: flex;
      text-align: center;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: .4em;
    }

    .tab-view-row {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      justify-content: center;
      gap: .4em;
    }

    .selection {
      display: inline-flex;
      padding: .4em;
      gap: .2em;
      border-radius: var(--radius);
      background-color: var(--line);
    }

    .selection .item {
      display: flex;
      border-radius: var(--radius);
    }

    .selection .item .text {
      font-family: var(--sans-serif);
      padding: .2em 1em;
      color: var(--foreground);
      border-radius: var(--radius);
    }

    .selection.is-icon .item .text {
      padding: .2em .4em;
    }

    .selection .item input {
      display: none;
    }

    .selection .item input:checked+.text {
      background-color: var(--selection);
    }

    .is-hidden {
      display: none;
    }
  </style>
</head>

<body>
  <main>
    <div id="main-container" class="container">
      <label>
        <input id="copy-text" class="form-control" aria-label="Copy text input field" name="copy-text" tabindex="0"
          placeholder="📋 CopyBoard">
      </label>
      <hr id="copy-text-horizon" />
      <div id="tab-switch" class="selection">
        <template id="tab-label-template">
          <label class="item">
            <input data-role="input" type="radio" name="tab-switch">
            <div data-role="label" class="text">Default</div>
          </label>
        </template>
      </div>
      <div id="tab-view-container" class="tab-view-container">
      </div>
      <template>
        <div class="tab-view-container">
          <div class="tab-view">
            <div class="tab-view-row">
              <button class="text-button">😂</button>
            </div>
          </div>
        </div>
      </template>
  </main>
  <footer>
    <div id="theme-selector" class="selection is-icon">
      <label class="item">
        <input type="radio" name="theme-selector" value="auto">
        <div class="text">🌐</div>
      </label>
      <label class="item">
        <input type="radio" name="theme-selector" value="light">
        <div class="text">🌞</div>
      </label>
      <label class="item">
        <input type="radio" name="theme-selector" value="dark" checked>
        <div class="text">🌚</div>
      </label>
    </div>
  </footer>

  <script>
    class Model {
      buttonMap = buttonMap;
      themes = ["auto", "light", "dark"];
      #theme = "dark";
      #tabIndex = "0";

      constructor() {
        this.theme = localStorage.getItem("copyboard-theme");
        this.tabIndex = localStorage.getItem("copyboard-tab-index");
      }

      get theme() {
        return this.#theme;
      }

      set theme(value) {
        this.#theme = this.themes.includes(value) ? value : this.themes[0];
        localStorage.setItem("copyboard-theme", this.#theme);
      }

      get tabIndex() {
        return this.#tabIndex;
      }

      set tabIndex(value) {
        const indices = Object.keys(buttonMap).map((_, i) => i);
        const index = typeof value === "number" ? value : parseInt(value, 10);
        this.#tabIndex = indices.includes(index) ? index : indices[0];
        localStorage.setItem("copyboard-tab-index", this.#tabIndex);
      }
    }

    class View {
      constructor() { }

      onThemeChange(callback) {
        const themeSelector = document.getElementById("theme-selector");
        themeSelector.addEventListener("change", (event) => {
          callback(event.target.value);
        });
      }

      onTabChange(callback) {
        const tabSwitch = document.getElementById("tab-switch");
        tabSwitch.addEventListener("change", (event) => {
          callback(event.target.value);
        });
      }

      switchTheme(theme) {
        document.documentElement.setAttribute("data-theme", theme);
        document.querySelector(`input[name="theme-selector"][value="${theme}"]`).checked = true;
      }

      switchTab(index) {
        document.querySelector(`input[name="tab-switch"][value="${index}"]`).checked = true;
        document.querySelectorAll("#tab-view-container > *").forEach((element, i) => {
          element.classList.toggle("is-hidden", i != index);
        });
      }

      renderButtonMap(buttonMap) {
        const tabSwitch = document.getElementById("tab-switch");
        const tabLabelTemplate = document.getElementById("tab-label-template");
        const tabViewContainer = document.getElementById("tab-view-container");

        Object.entries(buttonMap).forEach(([tabName, tabRows], tabIndex) => {
          const tabLabel = tabLabelTemplate.content.firstElementChild.cloneNode(true);
          tabLabel.dataset.index = tabIndex.toString();
          const input = tabLabel.querySelector('[data-role="input"]');
          const label = tabLabel.querySelector('[data-role="label"]');
          input.checked = tabIndex === 0;
          input.value = tabIndex.toString();
          input.dataset.index = tabIndex.toString();
          label.textContent = tabName;
          tabSwitch.appendChild(tabLabel);

          const tabView = document.createElement("div");
          tabView.classList.toggle("tab-view", true);
          tabView.classList.toggle("is-hidden", tabIndex > 0);
          tabView.dataset.index = tabIndex.toString();
          tabViewContainer.appendChild(tabView);

          tabRows.forEach((tabRow, tabRowIndex) => {
            const tabViewRow = document.createElement("div");
            tabViewRow.classList.toggle("tab-view-row", true);
            tabViewRow.dataset.index = tabRowIndex.toString();
            tabView.appendChild(tabViewRow);

            tabRow.forEach((button, buttonIndex) => {
              const buttonElement = document.createElement("button");
              buttonElement.classList.toggle("text-button", true);
              buttonElement.dataset.index = buttonIndex.toString();
              buttonElement.textContent = button;
              tabViewRow.appendChild(buttonElement);
            });
          });
        });
      }

      onTextButtonClick(callback) {
        console.log("onTextButtonClick");
        const buttons = document.querySelectorAll(".text-button");
        buttons.forEach(button => {
          button.addEventListener("click", (event) => {
            const text = event.target.textContent;
            console.log(text);
            callback(text);
          });
        });
      }

      renderCopiedText(text) {
        const copyTextInput = document.getElementById("copy-text");
        copyTextInput.value = text;
      }
    }

    class Controller {
      constructor(model = new Model(), view = new View()) {
        this.model = model;
        this.view = view;
      }

      init() {
        this.view.renderButtonMap(this.model.buttonMap);
        this.view.switchTheme(this.model.theme);
        this.view.switchTab(this.model.tabIndex);
        this.view.onThemeChange((theme) => this.handleThemeChange(theme));
        this.view.onTabChange((index) => this.handleTabChange(index));
        this.view.onTextButtonClick((text) => this.handleTextButtonClick(text));
      }

      handleThemeChange(theme) {
        this.model.theme = theme;
        this.view.switchTheme(this.model.theme);
      }

      handleTabChange(index) {
        this.model.tabIndex = index;
        this.view.switchTab(this.model.tabIndex);
      }

      handleTextButtonClick(text) {
        navigator.clipboard.writeText(text).catch(() => { })
        this.view.renderCopiedText(text);
      }
    }

    const control = new Controller();
    control.init();
  </script>
</body>

</html>